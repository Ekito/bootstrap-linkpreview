(function(e){var t=function(t,n){if(n===null||n.url===null)return;this.$element=e(t);this.url=n.url;this.init()};t.prototype={constructor:t,init:function(){this.getSource(this.url,this.renderPreview,this.renderError)},getSource:function(t,n,r){e.ajax({url:t,type:"GET",context:this,success:n,error:r})},renderPreview:function(t){console.log(t);t=t.replace(/<\/?[A-Z]+.*?>/g,function(e){return e.toLowerCase()});var n=new DOMParser,r=n.parseFromString(t,"text/xml"),i=e(r),s=this.findTitleInDom(i),o=this.findDescriptionInDom(i),u=e("<p></p>").addClass("lead").text(s),a=e("<p></p>").text(o);u.insertAfter(this.$element);a.insertAfter(u)},renderError:function(e){console.log("ERROR");console.log(e)},findTitleInDom:function(e){return e.find("title").text()||e.find("meta[name=title]").attr("content")},findDescriptionInDom:function(e){return e.find("meta[name=description]").attr("content")}};e.fn.linkpreview=function(n){return this.each(function(){var r=e(this),i=r.data("linkpreview"),s=typeof n=="object"&&n;i||r.data("linkpreview",i=new t(this,e.extend({},e.fn.linkpreview.defaults,s)));typeof n=="string"&&i[n]()})};e.fn.linkpreview.defaults={};e.fn.linkpreview.Constructor=t})(window.jQuery);